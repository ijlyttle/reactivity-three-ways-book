<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.1 Principles | Data-Science Reactivity: Three Ways</title>
  <meta name="description" content="3.1 Principles | Data-Science Reactivity: Three Ways" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="3.1 Principles | Data-Science Reactivity: Three Ways" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.1 Principles | Data-Science Reactivity: Three Ways" />
  
  
  

<meta name="author" content="Ian Lyttle" />


<meta name="date" content="2022-03-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="observable.html"/>
<link rel="next" href="demonstration-app-2.html"/>
<script src="libs/header-attrs-2.11.3/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script>
  // wait for the DOM to finish loading, then run function
  window.addEventListener('DOMContentLoaded', (event) => {

    // we want to set some element styles according to the class of the book
    //   - the theme of the book depends on class including:
    //       color-theme-1: means sepia
    //       color-theme-2: means night
    //       neither of these means white

    // see: https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver/observe#examples
    // identify an element to observe
    const elementToObserve = document.querySelector(".book");

    // create a new instance of `MutationObserver` named `observer`,
    // passing it a callback function
    const observer = new MutationObserver(function() {

      // img elements with src attribute that end in '.svg'
      const selImageSvg = 'img[src$=".svg"]';

      // span elements used for source-code highlighting
      const selCodeHighlight = 'code.sourceCode > span > span:not(.bu):not(.im)';

      // create a callback function for an element to change its style.filter
      const setFilter = (value) => {
        return (element) => element.style.filter = value;
      }

      if (elementToObserve.classList.contains('color-theme-1')) {
        // console.log('i am sepia');

        // sepia images
        document.querySelectorAll(selImageSvg).forEach(setFilter('sepia(100%'));

        // do nothing to highlighting
        document.querySelectorAll(selCodeHighlight).forEach(setFilter(null));

     } else if (elementToObserve.classList.contains('color-theme-2')) {
        // console.log('i am night');

        // invert images
        document.querySelectorAll(selImageSvg).forEach(setFilter('invert(100%)'));

        // invert highlighting
        document.querySelectorAll(selCodeHighlight).forEach(setFilter('invert(100%)'));

      } else {
        // console.log('i am white');

        // do nothing to images
        document.querySelectorAll(selImageSvg).forEach(setFilter(null));

        // do nothing to highlighting
        document.querySelectorAll(selCodeHighlight).forEach(setFilter(null));
      }

    });

    // call `observe()` on that MutationObserver instance,
    // passing it the element to observe, and the options object
    observer.observe(elementToObserve, {attributeFilter: ['class']});

    // touch class to initiate observe event
    elementToObserve.classList = elementToObserve.classList;

  });
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data-Science Reactivity: Three Ways</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="shiny.html"><a href="shiny.html"><i class="fa fa-check"></i><b>1</b> Shiny</a>
<ul>
<li class="chapter" data-level="1.1" data-path="principles.html"><a href="principles.html"><i class="fa fa-check"></i><b>1.1</b> Principles</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="principles.html"><a href="principles.html#pure-functions-vs.-side-effects"><i class="fa fa-check"></i><b>1.1.1</b> Pure functions vs. side effects</a></li>
<li class="chapter" data-level="1.1.2" data-path="principles.html"><a href="principles.html#reactives-vs.-observers"><i class="fa fa-check"></i><b>1.1.2</b> Reactives vs. observers</a></li>
<li class="chapter" data-level="1.1.3" data-path="principles.html"><a href="principles.html#using-tidyverse-functions"><i class="fa fa-check"></i><b>1.1.3</b> Using tidyverse functions</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="demonstration-app.html"><a href="demonstration-app.html"><i class="fa fa-check"></i><b>1.2</b> Demonstration App</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="demonstration-app.html"><a href="demonstration-app.html#description"><i class="fa fa-check"></i><b>1.2.1</b> Description</a></li>
<li class="chapter" data-level="1.2.2" data-path="demonstration-app.html"><a href="demonstration-app.html#prelims"><i class="fa fa-check"></i><b>1.2.2</b> Prelims</a></li>
<li class="chapter" data-level="1.2.3" data-path="demonstration-app.html"><a href="demonstration-app.html#helper-functions"><i class="fa fa-check"></i><b>1.2.3</b> Helper functions</a></li>
<li class="chapter" data-level="1.2.4" data-path="demonstration-app.html"><a href="demonstration-app.html#ui"><i class="fa fa-check"></i><b>1.2.4</b> UI</a></li>
<li class="chapter" data-level="1.2.5" data-path="demonstration-app.html"><a href="demonstration-app.html#server-function"><i class="fa fa-check"></i><b>1.2.5</b> Server function</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="dash.html"><a href="dash.html"><i class="fa fa-check"></i><b>2</b> Dash</a>
<ul>
<li class="chapter" data-level="2.1" data-path="principles-1.html"><a href="principles-1.html"><i class="fa fa-check"></i><b>2.1</b> Principles</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="principles-1.html"><a href="principles-1.html#everything-that-exists-is-a-component"><i class="fa fa-check"></i><b>2.1.1</b> Everything that exists is a component</a></li>
<li class="chapter" data-level="2.1.2" data-path="principles-1.html"><a href="principles-1.html#everything-that-happens-is-a-callback"><i class="fa fa-check"></i><b>2.1.2</b> Everything that happens is a callback</a></li>
<li class="chapter" data-level="2.1.3" data-path="principles-1.html"><a href="principles-1.html#server-cannot-store-state"><i class="fa fa-check"></i><b>2.1.3</b> Server cannot store state</a></li>
<li class="chapter" data-level="2.1.4" data-path="principles-1.html"><a href="principles-1.html#use-json-or-base64"><i class="fa fa-check"></i><b>2.1.4</b> Use JSON or base64</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="demonstration-app-1.html"><a href="demonstration-app-1.html"><i class="fa fa-check"></i><b>2.2</b> Demonstration app</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="demonstration-app-1.html"><a href="demonstration-app-1.html#description-1"><i class="fa fa-check"></i><b>2.2.1</b> Description</a></li>
<li class="chapter" data-level="2.2.2" data-path="demonstration-app-1.html"><a href="demonstration-app-1.html#prelims-1"><i class="fa fa-check"></i><b>2.2.2</b> Prelims</a></li>
<li class="chapter" data-level="2.2.3" data-path="demonstration-app-1.html"><a href="demonstration-app-1.html#helper-functions-1"><i class="fa fa-check"></i><b>2.2.3</b> Helper functions</a></li>
<li class="chapter" data-level="2.2.4" data-path="demonstration-app-1.html"><a href="demonstration-app-1.html#compmonent-layout"><i class="fa fa-check"></i><b>2.2.4</b> Compmonent layout</a></li>
<li class="chapter" data-level="2.2.5" data-path="demonstration-app-1.html"><a href="demonstration-app-1.html#callback-functions"><i class="fa fa-check"></i><b>2.2.5</b> Callback functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="observable.html"><a href="observable.html"><i class="fa fa-check"></i><b>3</b> Observable</a>
<ul>
<li class="chapter" data-level="3.1" data-path="principles-2.html"><a href="principles-2.html"><i class="fa fa-check"></i><b>3.1</b> Principles</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="principles-2.html"><a href="principles-2.html#hosted-service-runs-in-browser"><i class="fa fa-check"></i><b>3.1.1</b> Hosted service runs in browser</a></li>
<li class="chapter" data-level="3.1.2" data-path="principles-2.html"><a href="principles-2.html#reactivity-baked-in"><i class="fa fa-check"></i><b>3.1.2</b> Reactivity baked in</a></li>
<li class="chapter" data-level="3.1.3" data-path="principles-2.html"><a href="principles-2.html#javascript"><i class="fa fa-check"></i><b>3.1.3</b> JavaScript</a></li>
<li class="chapter" data-level="3.1.4" data-path="principles-2.html"><a href="principles-2.html#tidyverse-thinking-helps"><i class="fa fa-check"></i><b>3.1.4</b> Tidyverse thinking helps</a></li>
<li class="chapter" data-level="3.1.5" data-path="principles-2.html"><a href="principles-2.html#viewof-is-a-useful-construct"><i class="fa fa-check"></i><b>3.1.5</b> <code>viewof</code> is a useful construct</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="demonstration-app-2.html"><a href="demonstration-app-2.html"><i class="fa fa-check"></i><b>3.2</b> Demonstration app</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="demonstration-app-2.html"><a href="demonstration-app-2.html#showcase"><i class="fa fa-check"></i><b>3.2.1</b> Showcase</a></li>
<li class="chapter" data-level="3.2.2" data-path="demonstration-app-2.html"><a href="demonstration-app-2.html#workshop"><i class="fa fa-check"></i><b>3.2.2</b> Workshop</a></li>
<li class="chapter" data-level="3.2.3" data-path="demonstration-app-2.html"><a href="demonstration-app-2.html#appendix"><i class="fa fa-check"></i><b>3.2.3</b> Appendix</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="stray-thoughts.html"><a href="stray-thoughts.html"><i class="fa fa-check"></i><b>A</b> Stray Thoughts</a></li>
<li class="chapter" data-level="B" data-path="field-guide-to-python.html"><a href="field-guide-to-python.html"><i class="fa fa-check"></i><b>B</b> Field Guide to Python</a>
<ul>
<li class="chapter" data-level="B.1" data-path="python-installation.html"><a href="python-installation.html"><i class="fa fa-check"></i><b>B.1</b> Python installation</a></li>
<li class="chapter" data-level="B.2" data-path="project-management.html"><a href="project-management.html"><i class="fa fa-check"></i><b>B.2</b> Project management</a>
<ul>
<li class="chapter" data-level="B.2.1" data-path="project-management.html"><a href="project-management.html#git"><i class="fa fa-check"></i><b>B.2.1</b> Git</a></li>
<li class="chapter" data-level="B.2.2" data-path="project-management.html"><a href="project-management.html#virtual-environment"><i class="fa fa-check"></i><b>B.2.2</b> Virtual Environment</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data-Science Reactivity: Three Ways</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="principles-2" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Principles</h2>
<div id="hosted-service-runs-in-browser" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Hosted service runs in browser</h3>
<p>The best-known use for Observable is at the site for which is is named: <a href="https://observablehq.com/">Observable</a>.</p>
<p>Like many hosted services, the Observable website is free to use if everything you are doing is open, i.e. the GitHub model.</p>
<p>The Observable service uses the <a href="https://github.com/observablehq/runtime">Observable runtime</a> and the <a href="https://github.com/observablehq/stdlib">Observable standard-library</a>; these are also available in the new <a href="https://quarto.org/">Quarto</a> platform developed by RStudio.</p>
</div>
<div id="reactivity-baked-in" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Reactivity baked in</h3>
<p>Generally, each cell in an Observable notebook returns a value that is bound to a variable.
Here’s a straightforward example:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb69-1"><a href="principles-2.html#cb69-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="dv">3</span></span></code></pre></div>
<div class="sourceCode" id="cb70"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb70-1"><a href="principles-2.html#cb70-1" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> a</span></code></pre></div>
<p>If we change the first cell, such that <code>a = 4</code>, the value of <code>b</code> is automatically updated; we don’t need to run any other cells.</p>
<p>Although an Observable notebook appears like a Jupyter notebook, or like an RMarkdown document, there are some important differences:</p>
<ul>
<li><p>As mentioned above, values of cells are updated automatically, much like an Excel spreadsheet.</p></li>
<li><p>One consequence of this is that notebooks need not follow a linear order from top to bottom.
A value set later in the notebook can be referenced earlier in the notebook.</p></li>
<li><p>Just about everything you do in an Observable notebook is in a cell.
A cell can be JavaScript, Markdown, HTML, TeX, or SQL.
(The vast majority of cells in my notebooks are Markdown or JavaScript.)</p></li>
</ul>
</div>
<div id="javascript" class="section level3" number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> JavaScript</h3>
<p>Although Observable cells can use a variety of languages, the core language is JavaScript.
Or at least a close approximation to JavaScript.</p>
<p>Coming from R, these are the biggest things I need to keep in mind:</p>
<ul>
<li><p>Objects (analgous to R’s named lists) and arrays (analgous to R’s unnamed lists and vectors) are mutable.
If you pass an object as an argument to a function, then change the object in the function, the original object is changed.
This differs from R, and can lead to nasty surprises.</p></li>
<li><p>Strings and numbers are immutable.
Also, a scalar value is different from an array containing a single scalar value.</p></li>
</ul>
</div>
<div id="tidyverse-thinking-helps" class="section level3" number="3.1.4">
<h3><span class="header-section-number">3.1.4</span> Tidyverse thinking helps</h3>
<p>It <em>does</em> take a while to get used to JavaScript.
That said, it is more-and-more becoming a language for data-science alongside R and Python.</p>
<p>Personally, I rely on the mental models I have developed using dplyr, purrr, tidyr, and ggplot2.
When working in JavaScript, there may or may not be an analogue to the tidyverse function you have in mind.
The JavaScript function may take arguments in a different order, or have a completely different way of working.
For me, it helps to know “what I want to do with the data”.
It also helps to have the confidence of having done something similar using tidyverse.</p>
</div>
<div id="viewof-is-a-useful-construct" class="section level3" number="3.1.5">
<h3><span class="header-section-number">3.1.5</span> <code>viewof</code> is a useful construct</h3>
<p>This is something particular to Observable, not JavaScript in general.
Once I started to get comfortable with <code>viewof</code>, Observable got easier for me.</p>
<p>We’ll see this pattern used many times in the example, but it may be useful to
Consider an Observable input (not operable in this book):</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-32"></span>
<img src="images/observable-button-example.png" alt="Observable button" width="640" />
<p class="caption">
Figure 3.1: Observable button
</p>
</div>
<div class="sourceCode" id="cb71"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb71-1"><a href="principles-2.html#cb71-1" aria-hidden="true" tabindex="-1"></a>viewof clicks <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">button</span>(<span class="st">&quot;OK&quot;</span><span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">&quot;Click me&quot;</span>})</span></code></pre></div>
<p>In this context, the variable <code>clicks</code>:</p>
<ul>
<li>has a <em>value</em>: number of times the button has been clicked.</li>
<li>has a <em>view</em>: the rendered view in the browser.</li>
</ul>
<p>When we use <code>viewof clicks = ...</code>, we are telling Observable:</p>
<ul>
<li>we want to view the button <strong>here</strong></li>
<li>we want to bind the value of the button to the variable <code>clicks</code></li>
</ul>
<p>We can use the variable <code>clicks</code> elsewhere in the notebook.</p>
<p>The <em>view</em> is a side-effect; the <em>value</em> is, well, a value.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="observable.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="demonstration-app-2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub", "_main.mobi"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

</body>

</html>
